 20 constant maxiter -49 constant minval 50 constant maxval -37 constant mincol 37 constant maxcol variable creal variable cimag variable zreal variable zimag variable cnt variable scale_factor variable rescale variable s_escape : zr_sq zreal @ dup rescale @ */ ; : zi_sq zimag @ dup rescale @ */ ; : .char s" ..,'~!^:;[/<&?oxox# " drop + 1 type ; : escapes? s_escape @ > ; : count_and_test? cnt @ 1+ dup cnt ! maxiter > ; : init_vars 5 lshift dup creal ! zreal ! 5 lshift dup cimag ! zimag ! scale_factor @ 5 lshift rescale ! rescale @ 4 * s_escape ! 1 cnt ! ; : doescape zr_sq zi_sq 2dup + escapes? if 2drop true else - creal @ + zreal @ zimag @ rescale @ */ 1 lshift cimag @ + zimag ! zreal ! count_and_test? then ; : docell init_vars begin doescape until cnt @ .char ; : dorow maxval minval do dup i docell loop drop ; : mandelbrot cr maxcol mincol do i dorow cr loop ; : cmandel scale_factor @ 0 = if 20 scale_factor ! then cls mandelbrot ; : mandel scale_factor @ 0 = if 20 scale_factor ! then mandelbrot ; : tmandel uptime mandel uptime ; : tcmandel uptime cmandel uptime ; : multimandel 18 scale_factor ! 0 do scale_factor @ 1+ 1+ scale_factor ! mandel loop ; : tmultimandel 18 scale_factor ! 0 do scale_factor @ 1+ 1+ scale_factor ! tmandel loop ; : tcmultimandel 18 scale_factor ! 0 do scale_factor @ 1+ 1+ scale_factor ! tcmandel loop ; 